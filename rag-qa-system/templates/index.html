<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAG QA System</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .chat-container {
            height: 500px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .message {
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 10px;
        }
        .user-message {
            background-color: #007bff;
            color: white;
            text-align: right;
            margin-left: 20%;
        }
        .ai-message {
            background-color: #e9ecef;
            margin-right: 20%;
            line-height: 1.6;
        }
        .ai-message h3 {
            color: #0066cc;
            margin-top: 0;
            margin-bottom: 10px;
        }
        .ai-message table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .ai-message table th,
        .ai-message table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .ai-message table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        .ai-message strong {
            color: #0066cc;
        }
        .ai-message ul, .ai-message ol {
            padding-left: 20px;
        }
        .ai-message li {
            margin-bottom: 5px;
        }
        .source-doc {
            font-size: 0.85em;
            color: #6c757d;
            margin-top: 5px;
            padding: 5px;
            background-color: #f1f3f5;
            border-radius: 5px;
        }
        .upload-section {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .document-list {
            max-height: 200px;
            overflow-y: auto;
        }
        .admin-settings-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        .admin-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1001;
            overflow-y: auto;
        }
        .admin-panel.open {
            right: 0;
        }
        .admin-panel-header {
            background: #007bff;
            color: white;
            padding: 15px;
            position: sticky;
            top: 0;
        }
        .admin-panel-content {
            padding: 20px;
        }
        .admin-login-form {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .admin-action-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
        }
        .overlay.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Admin Settings Button -->
    <button class="btn btn-outline-secondary admin-settings-btn" onclick="toggleAdminPanel()">
        âš™ï¸ ê´€ë¦¬ì
    </button>

    <!-- Overlay -->
    <div class="overlay" id="adminOverlay" onclick="closeAdminPanel()"></div>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-panel-header">
            <div class="d-flex justify-content-between align-items-center">
                <h5 class="mb-0">âš™ï¸ ê´€ë¦¬ì ì„¤ì •</h5>
                <button class="btn btn-outline-light btn-sm" onclick="closeAdminPanel()">âœ•</button>
            </div>
        </div>
        <div class="admin-panel-content">
            <!-- Login Form -->
            <div class="admin-login-form" id="adminLoginForm">
                <h6>ğŸ” ê´€ë¦¬ì ì¸ì¦</h6>
                <div class="mb-3">
                    <input type="password" class="form-control" id="adminPassword" placeholder="ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸" onkeypress="handleAdminKeyPress(event)">
                </div>
                <button class="btn btn-primary w-100" onclick="adminLogin()">ë¡œê·¸ì¸</button>
            </div>

            <!-- Admin Actions (hidden until login) -->
            <div id="adminActions" style="display: none;">
                <div class="admin-action-group">
                    <h6>ğŸ—‘ï¸ ë°ì´í„° ê´€ë¦¬</h6>
                    <button class="btn btn-warning w-100 mb-2" onclick="resetAllData()">
                        ì „ì²´ ì‹œìŠ¤í…œ ë°ì´í„° ì´ˆê¸°í™”
                    </button>
                    <small class="text-muted">Chroma DB, Redis, SQLite ëª¨ë“  ë°ì´í„° ì‚­ì œ</small>
                </div>

                <div class="admin-action-group">
                    <h6>ğŸ“Š ìºì‹œ ê´€ë¦¬</h6>
                    <button class="btn btn-info w-100 mb-2" onclick="clearAllCache()">
                        ëª¨ë“  ìºì‹œ ì´ˆê¸°í™”
                    </button>
                    <button class="btn btn-secondary w-100 mb-2" onclick="clearRDBCache()">
                        RDB ìºì‹œë§Œ ì´ˆê¸°í™”
                    </button>
                </div>

                <div class="admin-action-group">
                    <h6>ğŸ”„ ë²¡í„° DB ê´€ë¦¬</h6>
                    <button class="btn btn-primary w-100 mb-2" onclick="resetVectorDB()">
                        ë²¡í„° DB ë¦¬ì…‹ ë° ì¬ë¡œë“œ
                    </button>
                </div>

                <div class="admin-action-group">
                    <h6>ğŸ“ˆ í†µê³„ í™•ì¸</h6>
                    <button class="btn btn-success w-100 mb-2" onclick="viewCacheStats()">
                        ìºì‹œ í†µê³„ ë³´ê¸°
                    </button>
                </div>

                <div class="admin-action-group">
                    <button class="btn btn-outline-danger w-100" onclick="adminLogout()">
                        ë¡œê·¸ì•„ì›ƒ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="container mt-5">
        <h1 class="text-center mb-4">ğŸ¤– RAG QA System</h1>
        
        <!-- Document Upload Section -->
        <div class="upload-section">
            <h4>ğŸ“„ ë¬¸ì„œ ì—…ë¡œë“œ</h4>
            <div class="row">
                <div class="col-md-8">
                    <input type="file" class="form-control" id="fileInput" accept=".pdf,.txt,.docx,.md">
                </div>
                <div class="col-md-4">
                    <button class="btn btn-primary w-100" onclick="uploadDocument()">ì—…ë¡œë“œ</button>
                </div>
            </div>
            <div class="mt-3">
                <h5>ë˜ëŠ” í…ìŠ¤íŠ¸ ì§ì ‘ ì…ë ¥:</h5>
                <textarea class="form-control" id="textInput" rows="3" placeholder="í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
                <button class="btn btn-secondary mt-2" onclick="uploadText()">í…ìŠ¤íŠ¸ ì¶”ê°€</button>
            </div>
            <div class="mt-3">
                <h5>ğŸ“š ì—…ë¡œë“œëœ ë¬¸ì„œ:</h5>
                <div id="documentList" class="document-list"></div>
                <div class="mt-2">
                    <button class="btn btn-danger btn-sm me-2" onclick="clearAllDocuments()">ëª¨ë“  ë¬¸ì„œ ì‚­ì œ</button>
                </div>
            </div>
        </div>
        
        <!-- Chat Interface -->
        <div class="card">
            <div class="card-body">
                <div class="chat-container" id="chatContainer">
                    <div class="message ai-message">
                        ì•ˆë…•í•˜ì„¸ìš”! RAG QA ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ë¬¸ì„œë¥¼ ì—…ë¡œë“œí•˜ê³  ì§ˆë¬¸í•´ì£¼ì„¸ìš”.
                    </div>
                </div>
                <div class="input-group mt-3">
                    <input type="text" class="form-control" id="questionInput" placeholder="ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleKeyPress(event)">
                    <button class="btn btn-primary" onclick="sendQuestion()">ì „ì†¡</button>
                    <button class="btn btn-secondary" onclick="clearChat()">ëŒ€í™” ì´ˆê¸°í™”</button>
                </div>
                <div class="form-check mt-2">
                    <input class="form-check-input" type="checkbox" id="useMemory">
                    <label class="form-check-label" for="useMemory">
                        ëŒ€í™” ê¸°ë¡ ì‚¬ìš©
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        // Load document list on page load
        window.onload = function() {
            loadDocumentList();
        };

        // Simple markdown to HTML conversion
        function formatMarkdown(text) {
            // Basic markdown formatting
            text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            text = text.replace(/\*(.*?)\*/g, '<em>$1</em>');
            
            // Headers
            text = text.replace(/^### (.*$)/gim, '<h3>$1</h3>');
            text = text.replace(/^## (.*$)/gim, '<h2>$1</h2>');
            text = text.replace(/^# (.*$)/gim, '<h1>$1</h1>');
            
            // Lists
            text = text.replace(/^\s*\n\*/gm, '<ul>\n*');
            text = text.replace(/^(\*.+)\s*\n([^\*])/gm, '$1\n</ul>\n\n$2');
            text = text.replace(/^\*(.+)/gm, '<li>$1</li>');
            
            // Numbered lists
            text = text.replace(/^\s*\n\d+\./gm, '<ol>\n1.');
            text = text.replace(/^(\d+\..+)\s*\n([^\d])/gm, '$1\n</ol>\n\n$2');
            text = text.replace(/^\d+\.(.+)/gm, '<li>$1</li>');
            
            // Line breaks
            text = text.replace(/\n\n/g, '</p><p>');
            text = '<p>' + text + '</p>';
            
            // Clean up empty paragraphs
            text = text.replace(/<p><\/p>/g, '');
            text = text.replace(/<p>(<h[1-6])/g, '$1');
            text = text.replace(/(<\/h[1-6]>)<\/p>/g, '$1');
            
            return text;
        }

        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendQuestion();
            }
        }

        async function sendQuestion() {
            const input = document.getElementById('questionInput');
            const question = input.value.trim();
            if (!question) return;

            const chatContainer = document.getElementById('chatContainer');
            const useMemory = document.getElementById('useMemory').checked;

            // Add user message
            chatContainer.innerHTML += `<div class="message user-message">${question}</div>`;
            input.value = '';

            try {
                const response = await fetch('/api/chat/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        question: question,
                        use_memory: useMemory 
                    })
                });

                const data = await response.json();
                
                if (data.error) {
                    chatContainer.innerHTML += `<div class="message ai-message">ì˜¤ë¥˜: ${data.error}</div>`;
                } else {
                    // Format the answer with markdown
                    const formattedAnswer = formatMarkdown(data.answer);
                    let aiMessage = `<div class="message ai-message">${formattedAnswer}`;
                    
                    // Add source documents if available
                    if (data.source_documents && data.source_documents.length > 0) {
                        aiMessage += '<div class="source-doc"><strong>ğŸ“„ ì°¸ê³  ë¬¸ì„œ:</strong><br>';
                        data.source_documents.forEach((doc, idx) => {
                            aiMessage += `${idx + 1}. ${doc.metadata.source_file || doc.metadata.title || doc.metadata.filename || 'Unknown'}<br>`;
                        });
                        aiMessage += '</div>';
                    }
                    
                    aiMessage += '</div>';
                    chatContainer.innerHTML += aiMessage;
                }
            } catch (error) {
                chatContainer.innerHTML += `<div class="message ai-message">ì˜¤ë¥˜: ${error.message}</div>`;
            }

            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function uploadDocument() {
            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];
            if (!file) {
                alert('íŒŒì¼ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            try {
                const response = await fetch('/api/document/upload', {
                    method: 'POST',
                    body: formData
                });

                const data = await response.json();
                if (data.error) {
                    alert(`ì—…ë¡œë“œ ì‹¤íŒ¨: ${data.error}`);
                } else {
                    alert(`ì—…ë¡œë“œ ì„±ê³µ! ${data.chunks_created}ê°œì˜ ì²­í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    fileInput.value = '';
                    loadDocumentList();
                }
            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function uploadText() {
            const textInput = document.getElementById('textInput');
            const text = textInput.value.trim();
            if (!text) {
                alert('í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch('/api/document/upload-text', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        text: text,
                        title: 'Direct Input ' + new Date().toLocaleString()
                    })
                });

                const data = await response.json();
                if (data.error) {
                    alert(`ì—…ë¡œë“œ ì‹¤íŒ¨: ${data.error}`);
                } else {
                    alert(`í…ìŠ¤íŠ¸ ì¶”ê°€ ì„±ê³µ! ${data.chunks_created}ê°œì˜ ì²­í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    textInput.value = '';
                    loadDocumentList();
                }
            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function loadDocumentList() {
            try {
                const response = await fetch('/api/document/list');
                const data = await response.json();
                
                const listContainer = document.getElementById('documentList');
                if (data.files && data.files.length > 0) {
                    listContainer.innerHTML = data.files.map(file => 
                        `<div>ğŸ“„ ${file.filename} (${(file.size / 1024).toFixed(2)} KB)</div>`
                    ).join('');
                    listContainer.innerHTML += `<div class="mt-2"><strong>ì´ ì²­í¬ ìˆ˜: ${data.total_chunks}</strong></div>`;
                } else {
                    listContainer.innerHTML = '<div class="text-muted">ì—…ë¡œë“œëœ ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                }
            } catch (error) {
                console.error('ë¬¸ì„œ ëª©ë¡ ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        async function clearAllDocuments() {
            if (!confirm('ëª¨ë“  ë¬¸ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            try {
                const response = await fetch('/api/document/clear-all', {
                    method: 'DELETE'
                });

                const data = await response.json();
                alert(data.message || 'ë¬¸ì„œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
                loadDocumentList();
            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function clearChat() {
            document.getElementById('chatContainer').innerHTML = 
                '<div class="message ai-message">ëŒ€í™”ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤. ìƒˆë¡œìš´ ì§ˆë¬¸ì„ í•´ì£¼ì„¸ìš”.</div>';
            
            // Clear memory on server
            await fetch('/api/chat/clear-memory', { method: 'POST' });
        }

        // Admin Panel Variables
        let adminToken = null;

        // Admin Panel Functions
        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            const overlay = document.getElementById('adminOverlay');
            
            if (panel.classList.contains('open')) {
                closeAdminPanel();
            } else {
                panel.classList.add('open');
                overlay.classList.add('show');
            }
        }

        function closeAdminPanel() {
            const panel = document.getElementById('adminPanel');
            const overlay = document.getElementById('adminOverlay');
            
            panel.classList.remove('open');
            overlay.classList.remove('show');
        }

        function handleAdminKeyPress(event) {
            if (event.key === 'Enter') {
                adminLogin();
            }
        }

        async function adminLogin() {
            const password = document.getElementById('adminPassword').value;
            if (!password) {
                alert('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.');
                return;
            }

            try {
                const response = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ password: password })
                });

                if (response.ok) {
                    const data = await response.json();
                    adminToken = data.token;
                    
                    // Hide login form and show admin actions
                    document.getElementById('adminLoginForm').style.display = 'none';
                    document.getElementById('adminActions').style.display = 'block';
                    
                    alert('ê´€ë¦¬ì ë¡œê·¸ì¸ ì„±ê³µ!');
                } else {
                    alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                    document.getElementById('adminPassword').value = '';
                }
            } catch (error) {
                alert(`ë¡œê·¸ì¸ ì˜¤ë¥˜: ${error.message}`);
            }
        }

        function adminLogout() {
            adminToken = null;
            document.getElementById('adminLoginForm').style.display = 'block';
            document.getElementById('adminActions').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        }

        async function resetAllData() {
            if (!adminToken) {
                alert('ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            if (!confirm('âš ï¸ ê²½ê³ : ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤!\n\në‹¤ìŒ ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤:\n- Chroma ë²¡í„° ë°ì´í„°ë² ì´ìŠ¤\n- Redis ìºì‹œ\n- SQLite ìºì‹œ ë° í†µê³„\n- ëª¨ë“  ê²€ìƒ‰ ê¸°ë¡\n\nì •ë§ ì§„í–‰í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            try {
                const response = await fetch('/api/admin/system/reset-all', {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${adminToken}`,
                        'Content-Type': 'application/json'
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    let message = 'âœ… ì „ì²´ ë°ì´í„° ì´ˆê¸°í™” ì™„ë£Œ!\n\n';
                    
                    if (data.chroma_db?.status === 'success') {
                        message += `ğŸ“Š Chroma DB: ${data.chroma_db.deleted_documents}ê°œ ë¬¸ì„œ ì‚­ì œ\n`;
                    }
                    
                    if (data.redis?.status === 'success') {
                        message += `ğŸ”´ Redis: ${data.redis.cleared_keys}ê°œ í‚¤ ì‚­ì œ\n`;
                    } else if (data.redis?.status === 'skipped') {
                        message += `ğŸ”´ Redis: ${data.redis.message}\n`;
                    }
                    
                    if (data.sqlite?.status === 'success') {
                        message += `ğŸ’¾ SQLite: ${data.sqlite.total_cleared}ê°œ ë ˆì½”ë“œ ì‚­ì œ\n`;
                    }
                    
                    alert(message);
                    
                    // UI ìƒˆë¡œê³ ì¹¨
                    loadDocumentList();
                    clearChat();
                } else {
                    alert(`ì´ˆê¸°í™” ì‹¤íŒ¨: ${data.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`);
                }

            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function clearAllCache() {
            if (!adminToken) {
                alert('ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            try {
                const response = await fetch('/api/admin/cache/clear-all', {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${adminToken}`
                    }
                });

                const data = await response.json();
                alert(data.message || 'ëª¨ë“  ìºì‹œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function clearRDBCache() {
            if (!adminToken) {
                alert('ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            try {
                const response = await fetch('/api/admin/cache/clear-rdb', {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${adminToken}`
                    }
                });

                const data = await response.json();
                alert(data.message || 'RDB ìºì‹œê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function resetVectorDB() {
            if (!adminToken) {
                alert('ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            if (!confirm('ë²¡í„° DBë¥¼ ë¦¬ì…‹í•˜ê³  ë¬¸ì„œë¥¼ ì¬ë¡œë“œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                return;
            }

            try {
                const response = await fetch('/api/admin/vectordb/reset', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${adminToken}`
                    }
                });

                const data = await response.json();
                alert(data.message || 'ë²¡í„° DB ë¦¬ì…‹ ì™„ë£Œ');
                loadDocumentList();
            } catch (error) {
                alert(`ì˜¤ë¥˜: ${error.message}`);
            }
        }

        async function viewCacheStats() {
            if (!adminToken) {
                alert('ê´€ë¦¬ì ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                return;
            }

            try {
                const response = await fetch('/api/admin/cache/hybrid-stats', {
                    headers: {
                        'Authorization': `Bearer ${adminToken}`
                    }
                });

                const data = await response.json();
                
                let statsMessage = 'ğŸ“ˆ ìºì‹œ í†µê³„\n\n';
                
                if (data.redis_stats) {
                    statsMessage += `ğŸ”´ Redis:\n`;
                    statsMessage += `  - ì´ í‚¤: ${data.redis_stats.total_keys}\n`;
                    statsMessage += `  - ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: ${data.redis_stats.memory_usage}\n\n`;
                }
                
                if (data.sqlite_stats) {
                    statsMessage += `ğŸ’¾ SQLite:\n`;
                    statsMessage += `  - ì¿¼ë¦¬ ìºì‹œ: ${data.sqlite_stats.total_entries}ê°œ\n`;
                    statsMessage += `  - ì´ íˆíŠ¸: ${data.sqlite_stats.total_hits}íšŒ\n`;
                    statsMessage += `  - ìºì‹œ í¬ê¸°: ${data.sqlite_stats.cache_size_mb}MB\n`;
                }
                
                alert(statsMessage);
            } catch (error) {
                alert(`í†µê³„ ì¡°íšŒ ì˜¤ë¥˜: ${error.message}`);
            }
        }
    </script>
</body>
</html>